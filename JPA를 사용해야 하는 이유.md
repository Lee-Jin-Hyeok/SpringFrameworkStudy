## JPA를 사용해야 하는 이유

### 1. 개요

스프링에서는 ORM 기술을 자바에서 사용하기 위해서 ORM 기술의 표준인 JPA(Java Persistence API)를 제공한다.
JPA는 ORM 기술의 표준이므로 ORM과 마찬가지로 기술의 인터페이스에 불가하다.
따라서 우리가 JPA를 사용한다라고 했을 때 사용하는 것은 JPA를 구현한 구현체가 된다.
JPA의 대표적인 구현체로는 Hibernate(하이버네이트)와 Eclipse JPA가 있다.

스프링 부트에서는 JPA 기술을 사용하고자 Gradle이나 Maven과 같은 빌드 도구에 작성해놓으면
Hibernate가 자동으로 사용이 된다. (물론 변경이 가능하다.)
그만큼 Hibernate는 JPA의 표준 기술이라고 해도 될 정도로 많이 사용된다.

요즘에는 ORM 기술을 사용하기 위해서 Mybatis(마이바티스)와 Hibernate가 많이 사용되는데
특히 중국이나 우리나라 같은 경우에는 Mybatis를 더 선호하는 경향이 있다.
이는 Hibernate와 관련된 기술의 서적이 많이 있지 않기 때문이었는데
나는 "김영한"님께서 지으신 "자바 ORM 표준 JPA 프로그래밍"이라는 책을 읽고 공부하고자 한다.
현재는 이 책 말고도 JPA에 관한 좋은 책들이 많지만 김영한님에 대한 존경에 대한 의미로 이 책을 읽게 되었다.

결론적으로 이번 글에서는 JPA를 사용해야 하는 이유에 대해서 말하고자 한다.

### 2. 지나친 SQL문의 반복

기존에 JPA를 사용하지 않고 JdbcTemplate를 사용하지 않고 데이터베이스에 접근하고자 한다면
우리는 메인 로직에서 Connection을 생성하고 PreparedStatement(Statement)를 생성한 뒤
ResultSet를 통해 값을 받아내는 등의 작업을 했어야 했다.

그래서 이들을 그나마 쉽게 사용하기 위해서 Connection, PreparedStatement 생성문과 ResultSet을 통한
값을 가져오는 작업을 따로 DAO 클래스로 나누어서 사용하기도 하였다.

이러한 작업이 불편하여 스프링에서는 JdbcTemplate를 이용하여 기존에 JDBC로는 부족했던
데이터베이스 접근 방식을 개편하여 쉽게 데이터베이스에 접근할 수 있도록 지원하였다.
하지만 여전히 SQL문을 개발자가 직접 작성해야 한다는 큰 문제점이 있었다.

데이터베이스를 어느정도 공부해서 SQL을 알면 되지 않느냐라고 생각할 수도 있다.
하지만 SQL문을 알아서 데이터베이스의 값들을 쉽게 가져올 수 있는 것이 문제가 아니라
개발자가 집중해야할 로직이 아니라 SQL문을 작성하는 일을 담당하고 있다면
그것은 효율적인 측면에서도 안 좋고 중복된 코드들을 작성하면서 흥미를 잃기 딱 좋은 작업이 될 것이다.
그래서 이러한 SQL문의 반복을 줄이기 위해서 JPA라는 기술이 등장하게 된 것이다.

### 3. 객체와 데이터베이스의 근본 차이

자바에서 데이터베이스에 접근하기 위해서 많은 SQL문을 작성하는 것도 문제이지만
사실 가장 큰 문제는 자바의 객체와 데이터베이스의 테이블은 각각 하는 역할이 다른 것이 문제라고 할 수 있다.

데이터베이스(RDBMS인 경우)는 값을 저장하고 테이블끼리의 연관 관계를 설정하는데에 관심사가 담겨있다.
하지만 객체의 경우에는 값을 저장하는 것이 큰 관심사가 아니라 이를 상속하고 발전시키는데에 있다.
그리고 상속과 같은 개념을 데이터베이스에 적용시킬 수는 있지만 이를 완벽하게 따라하기가 어렵기 때문에
우리는 자바 코드에서 RowMapper를 통해서 데이터베이스의 값을 적절히 가져와서 매핑하는 역할을 한다.

그러면 개발자는 데이터베이스에 존재하는 값을 가져와서 자바 객체와 비교한 후
그 객체에 값이 제대로 들어갈 수 있도록 매핑하여 저장해야 한다.
그런데 상속되어 있는 객체라던가 객체 안에 다른 객체가 있듯이
이런 복잡한 현상이 일어날 경우 매핑하기가 더 어려워지게 된다.
이런 객체와 데이터베이스의 차이가 존재하기 때문에 일반적으로 매핑하는 것은 무리가 있다.

그런데 만약 데이터베이스가 아니라 자바(객체지향언어)에서 지원하는 Map(HashMap)을 사용하여
데이터베이스처럼 사용하면 어떨까?
자바에서 Map을 이용하여 객체를 저장하고자 한다면
Map의 메소드인 add() 메소드를 이용하여 객체를 바로 저장할 수 있다.
기존에 데이터베이스를 사용할 경우에는 수많은 매핑을 통해 저장해야 했다면
Map에서는 단 한줄의 코드로 저장할 수 있게 된다.
이는 데이터베이스와 객체의 관심사가 다르고
Map과 같은 자료형은 객체지향적 아니 코드의 관심사에 더 알맞게 설계되어 있기 때문에
더 간단하게 사용이 가능한 것이다.
이러한 차이를 극복하고 데이터베이스와 객체 사이에서 매핑해주는 과정을
JPA가 대신 해주고 개발자는 주요 로직을 개발하는데 힘쓸 수 있도록 도와주기 때문에
우리는 JPA를 사용해야 한다.